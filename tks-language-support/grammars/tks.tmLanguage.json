{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "ToolkitScript",
  "scopeName": "source.tks",
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#section-markers"
    },
    {
      "include": "#commands"
    },
    {
      "include": "#image-locators"
    },
    {
      "include": "#locators"
    },
    {
      "include": "#parameters"
    },
    {
      "include": "#operators"
    },
    {
      "include": "#numbers"
    },
    {
      "include": "#strings"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.number-sign.tks",
          "match": "#.*$"
        }
      ]
    },
    "section-markers": {
      "patterns": [
        {
          "name": "keyword.control.section.tks",
          "match": "^\\s*(步骤)\\s*:",
          "captures": {
            "1": {
              "name": "entity.name.section.tks"
            }
          }
        }
      ]
    },
    "commands": {
      "patterns": [
        {
          "name": "keyword.control.process.tks",
          "match": "\\b(启动|关闭)\\b"
        },
        {
          "name": "keyword.control.interaction.tks",
          "match": "\\b(点击|按压|滑动|拖动|定向拖动)\\b"
        },
        {
          "name": "keyword.control.input.tks",
          "match": "\\b(输入|清理|隐藏键盘)\\b"
        },
        {
          "name": "keyword.control.timing.tks",
          "match": "\\b(等待)\\b"
        },
        {
          "name": "keyword.control.navigation.tks",
          "match": "\\b(返回)\\b"
        },
        {
          "name": "keyword.control.assertion.tks",
          "match": "\\b(断言|读取)\\b"
        },
        {
          "name": "constant.language.direction.tks",
          "match": "\\b(up|down|left|right)\\b"
        },
        {
          "name": "constant.language.assertion-state.tks",
          "match": "\\b(存在|不存在|可见|不可见)\\b"
        }
      ]
    },
    "image-locators": {
      "patterns": [
        {
          "name": "entity.name.tag.image-locator.tks",
          "begin": "@\\{",
          "end": "\\}",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.image-locator.begin.tks"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.image-locator.end.tks"
            }
          },
          "patterns": [
            {
              "name": "string.unquoted.image-locator-name.tks",
              "match": "[^}]+"
            }
          ]
        }
      ]
    },
    "locators": {
      "patterns": [
        {
          "name": "entity.name.tag.locator.tks",
          "begin": "(?<!@)\\{",
          "end": "\\}",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.locator.begin.tks"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.locator.end.tks"
            }
          },
          "patterns": [
            {
              "include": "#coordinate"
            },
            {
              "name": "string.unquoted.locator-name.tks",
              "match": "[^,}]+"
            }
          ]
        }
      ]
    },
    "coordinate": {
      "patterns": [
        {
          "name": "meta.coordinate.tks",
          "match": "\\d+\\s*,\\s*\\d+",
          "captures": {
            "0": {
              "name": "constant.numeric.coordinate.tks"
            }
          }
        }
      ]
    },
    "parameters": {
      "patterns": [
        {
          "name": "meta.parameters.tks",
          "begin": "\\[",
          "end": "\\]",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.begin.tks"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.end.tks"
            }
          },
          "patterns": [
            {
              "include": "#image-locators"
            },
            {
              "include": "#locators"
            },
            {
              "include": "#numbers"
            },
            {
              "include": "#strings"
            },
            {
              "name": "punctuation.separator.parameter.tks",
              "match": ","
            }
          ]
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.comparison.tks",
          "match": "=="
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.tks",
          "match": "\\b\\d+\\b"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.tks",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.tks",
              "match": "\\\\."
            }
          ]
        },
        {
          "name": "string.unquoted.text.tks",
          "match": "(?<=,\\s)(?!\\{)[^\\[\\]\\{\\},]+(?=\\s*[\\]\\}]|$)"
        }
      ]
    }
  }
}
